# Спецификация: Дуэль один на один - Режим файтинга
**Контекст:** DuelGame
**Статус:** Черновик

## 1. Бизнес-цель (Пользовательская история)
> Как игрок, я хочу бросать вызов другим игрокам в 1v1 битвах викторин в режиме реального времени, где каждый правильный ответ наносит урон моему оппоненту, создавая интенсивность файтинга в сочетании с интеллектуальным соревнованием.

## 2. Единый язык (Ubiquitous Language)
- **Duel (Дуэль):** Битва викторин 1v1 в режиме реального времени с механикой файтинга.
- **HP (Health Points) (Очки здоровья):** Непрерывная система здоровья (0-100 на игрока). Первый, кто достигнет 0 HP, проигрывает.
- **Combo (Комбо):** Цепочка последовательных правильных ответов, которая усиливает урон, наносимый оппоненту.
- **Damage (Урон):** Уменьшение HP, наносимое оппоненту при правильном ответе (базовый: 15 HP).
- **Critical Hit (Критический удар):** Бонус к урону за ответ в течение первых 3 секунд после показа вопроса.
- **Speed Window (Окно скорости):** Первые 3 секунды вопроса, когда можно нанести критический удар.
- **Special Move (Специальный прием):** Автоматически активируемая мощная атака на вехах Комбо (3, 5, 7).
- **Defense (Block) (Защита (Блок)):** Уменьшение урона (50%), когда оппонент отвечает быстрее вас.
- **KO (Knockout) (Нокаут):** Победа, когда HP оппонента достигает 0.

## 3. Бизнес-правила и логика
1. **Базовый урон:** Правильные ответы наносят 15 HP урона. Неправильные ответы наносят 10 HP само-урона и сбрасывают Комбо. Тайм-ауты наносят 5 HP само-урона.
2. **Множители комбо:** Урон умножается на x1.3 (Комбо 2-3), x1.6 (Комбо 4-5) и x2.0 (Комбо 6+).
3. **Критический удар:** Ответ в течение первых 3 секунд добавляет бонус +50% к урону.
4. **Специальные приемы:** Автоматически активируются при Комбо 3 (40 HP), Комбо 5 (50 HP + 2с оглушение) и Комбо 7 (70 HP). Они заменяют обычный урон и сбрасывают Комбо.
5. **Механизм защиты:** Если оба игрока отвечают правильно, более быстрый игрок наносит полный урон, в то время как более медленный игрок наносит только 50% урона (заблокировано).
6. **Расчет урона:** Множители применяются последовательно с округлением вниз после каждого шага: Базовый урон → Множитель комбо → Крит/Блок.
7. **Условия победы:** Матч завершается немедленно, если HP игрока достигает 0 (KO). Если все 10 вопросов отвечены, побеждает игрок с большим HP.
8. **Подбор противника:** Игроки подбираются на основе Рейтинга ±150 очков.

## 4. Сценарии (Пользовательские потоки)
- **Сценарий: Критическое комбо**
    - **Дано:** У обоих игроков Комбо = 2, оба отвечают правильно.
    - **Когда:** Игрок отвечает за 2.5с (критический удар), оппонент за 5с (медленнее).
    - **Тогда:** Игрок наносит 28 HP (15 базовый → 19 с комбо x1.3 → 28 с критом +50%), оппонент наносит 9 HP (15 базовый → 19 с комбо x1.3 → 9 с блоком -50%).

- **Сценарий: Специальный прием - Ультимативная атака**
    - **Дано:** У игрока Комбо = 6, у оппонента 80 HP.
    - **Когда:** Игрок отвечает на следующий вопрос правильно.
    - **Тогда:** Комбо достигает 7, запуская "Ультимативную атаку" на 70 HP урона; Комбо игрока сбрасывается до 0.

- **Сценарий: Идеальная победа нокаутом**
    - **Дано:** У игрока 100 HP, у оппонента 25 HP.
    - **Когда:** Игрок отвечает правильно (Комбо 5), а оппонент совершает ошибку.
    - **Тогда:** HP оппонента достигает 0, и матч немедленно завершается победой нокаутом.
