# Спецификация: Ежедневный марафон - Испытание на выживание
**Контекст:** DailyMarathon
**Статус:** Утверждено

## 1. Бизнес-цель (Пользовательская история)
> Как игрок, я хочу испытать свою выносливость в ежедневном испытании на выживание с прогрессивной сложностью, где каждая ошибка дорого мне обходится, а тщательная стратегия определяет, как далеко я смогу зайти.

## 2. Единый язык (Ubiquitous Language)
- **Daily Marathon (Ежедневный марафон):** Режим выживания с ограничением по времени и прогрессивными этапами, доступный раз в 24 часа.
- **Lives (Жизни):** Система здоровья, представленная 3 дискретными шансами (❤️ ❤️ ❤️).
- **Permadeath (Окончательная смерть):** Немедленное завершение сессии, когда Жизни достигают нуля.
- **Stage (Этап):** Последовательный уровень сложности (Легкий → Средний → Тяжелый → Элитный).
- **Power-up (Усиление):** Расходуемый предмет, дающий тактическое преимущество (50/50, Продление времени, Пропуск).
- **Streak (Серия):** Цепочка последовательных правильных ответов в рамках текущего этапа.
- **Speed Window (Окно скорости):** Первые 5-8 секунд вопроса, когда можно заработать дополнительные очки за скорость.

## 3. Бизнес-правила и логика
1. **Начальное состояние:** Каждый игрок начинает ровно с 3 жизнями.
2. **Потеря жизни:** Неправильные ответы или тайм-ауты уменьшают Жизни на 1.
3. **Окончательная смерть:** Сессия завершается немедленно, когда Жизни достигают 0. Возрождения не допускаются.
4. **Дневной лимит:** Только одна попытка за 24-часовой период (сброс в полночь UTC).
5. **Продвижение:** Необходимо завершить текущий этап с Жизни ≥ 1, чтобы разблокировать следующий этап.
6. **Получение усилений:** Награждаются за завершение этапа (случайно) или достижение Серии из 5 вопросов.
7. **Использование усилений:** Расходуемые предметы (50/50, Продление времени, Пропуск) специфичны для сессии и не переносятся.
8. **Формула подсчета очков:** `FinalScore = Sum(QuestionScores) + StageBonuses`.
    - **Бонус за завершение этапа:** `500 * StageNumber`.
    - **Бонус за выживание:** `200 * RemainingLives` в конце этапа.

## 4. Сценарии (Пользовательские потоки)
- **Сценарий: Идеальное прохождение этапа**
    - **Дано:** Игрок на Этапе 1 с 3 жизнями, ответил на 4/5 вопросов правильно.
    - **Когда:** Игрок отвечает на финальный вопрос правильно в течение Окна скорости.
    - **Тогда:** Серия достигает 5, игрок получает усиление 50/50, получает Бонус за завершение этапа и переходит на Этап 2.

- **Сценарий: Стратегическое использование усиления**
    - **Дано:** Игрок на Этапе 3, у него осталась 1 жизнь и усиление Пропуск.
    - **Когда:** Игрок сталкивается с чрезвычайно сложным вопросом и использует Пропуск.
    - **Тогда:** Игрок переходит к следующему вопросу без потери жизни и без получения очков за пропущенный вопрос.

- **Сценарий: Драматическая окончательная смерть**
    - **Дано:** Игрок на Этапе 4 с 1 оставшейся жизнью.
    - **Когда:** Таймер игрока истекает на вопросе.
    - **Тогда:** Жизни падают до 0, сессия немедленно завершается, и отображается экран "Игра окончена".
